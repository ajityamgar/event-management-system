{% extends "base.html" %}
{% block title %}Admin Dashboard - EventPro{% endblock %}
{% block content %}
<div style="margin-bottom: 40px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
        <h1 style="font-size: 28px; color: #1f2937;">Admin Dashboard</h1>
        <a href="{{ url_for('admin_events') }}" class="btn btn-primary" style="background: #6366f1; color: white; padding: 10px 24px; text-decoration: none; border-radius: 6px;">View All Events</a>
    </div>
    
    <!-- Key Metrics -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #6366f1;">
            <div style="font-size: 32px; font-weight: bold; color: #6366f1;">{{ total_users }}</div>
            <div style="font-size: 14px; color: #6b7280;">Total Users</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #10b981;">
            <div style="font-size: 32px; font-weight: bold; color: #10b981;">{{ total_events }}</div>
            <div style="font-size: 14px; color: #6b7280;">Total Events</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #f59e0b;">
            <div style="font-size: 32px; font-weight: bold; color: #f59e0b;">{{ pending_events }}</div>
            <div style="font-size: 14px; color: #6b7280;">Pending Approval</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #3b82f6;">
            <div style="font-size: 32px; font-weight: bold; color: #3b82f6;">₹{{ total_revenue|int|default(0) }}</div>
            <div style="font-size: 14px; color: #6b7280;">Total Revenue</div>
        </div>
    </div>

    <!-- Status Breakdown -->
    <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 40px;">
        <h2 style="margin-bottom: 20px; color: #1f2937;">Events by Status</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
            {% for status, count in status_breakdown.items() %}
            <div style="text-align: center; padding: 15px; background: #f9fafb; border-radius: 8px;">
                <div style="font-size: 24px; font-weight: bold; color: #6366f1;">{{ count }}</div>
                <div style="font-size: 12px; color: #6b7280; margin-top: 5px;">{{ status }}</div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Recent Events -->
    <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <h2 style="margin-bottom: 20px; color: #1f2937;">Recent Events</h2>
        {% if recent_events %}
        <table style="width: 100%; border-collapse: collapse;">
            <thead style="background: #f9fafb;">
                <tr>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Event Name</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Client</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Date</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Status</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Cost</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for event in recent_events %}
                <tr style="border-bottom: 1px solid #e5e7eb;">
                    <td style="padding: 14px;">{{ event.name }}</td>
                    <td style="padding: 14px;">{{ event.client.username }}</td>
                    <td style="padding: 14px;">{{ event.event_date.strftime('%d-%m-%Y') }}</td>
                    <td style="padding: 14px;">
                        <span style="display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; background: #d1fae5; color: #065f46;">
                            {{ event.status.value }}
                        </span>
                    </td>
                    <td style="padding: 14px;">₹{{ event.total_cost|int|default(0) }}</td>
                    <td style="padding: 14px;">
                        <a href="{{ url_for('admin_view_event', event_id=event.id) }}" style="color: #6366f1; text-decoration: none; font-size: 12px; font-weight: 600;">View</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="color: #6b7280; text-align: center; padding: 40px;">No events found.</p>
        {% endif %}
    </div>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 40px;">
    <a href="{{ url_for('admin_users') }}" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-decoration: none; color: #1f2937; text-align: center; transition: all 0.3s;">
        <i class="fas fa-users" style="font-size: 32px; color: #6366f1; display: block; margin-bottom: 10px;"></i>
        <h3>Manage Users</h3>
        <p style="color: #6b7280; font-size: 12px;">{{ total_users }} users</p>
    </a>
    <a href="{{ url_for('admin_venues') }}" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-decoration: none; color: #1f2937; text-align: center; transition: all 0.3s;">
        <i class="fas fa-building" style="font-size: 32px; color: #ec4899; display: block; margin-bottom: 10px;"></i>
        <h3>Manage Venues</h3>
        <p style="color: #6b7280; font-size: 12px;">View & edit venues</p>
    </a>
    <a href="{{ url_for('admin_vendors') }}" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-decoration: none; color: #1f2937; text-align: center; transition: all 0.3s;">
        <i class="fas fa-handshake" style="font-size: 32px; color: #10b981; display: block; margin-bottom: 10px;"></i>
        <h3>Manage Vendors</h3>
        <p style="color: #6b7280; font-size: 12px;">View & edit vendors</p>
    </a>
    <a href="{{ url_for('admin_packages') }}" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-decoration: none; color: #1f2937; text-align: center; transition: all 0.3s;">
        <i class="fas fa-gift" style="font-size: 32px; color: #f59e0b; display: block; margin-bottom: 10px;"></i>
        <h3>Manage Packages</h3>
        <p style="color: #6b7280; font-size: 12px;">View & edit packages</p>
    </a>
</div>
{% endblock %}
