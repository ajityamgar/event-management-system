{% extends "base.html" %}
{% block title %}Dashboard - EventPro{% endblock %}
{% block content %}
<div style="margin-bottom: 40px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
        <h1 style="font-size: 28px; color: #1f2937;">My Dashboard</h1>
        <a href="{{ url_for('create_event') }}" class="btn btn-primary" style="background: #6366f1; color: white; padding: 10px 24px; text-decoration: none; border-radius: 6px;">+ Create Event</a>
    </div>
    
    <!-- Stats -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #6366f1;">
            <div style="font-size: 32px; font-weight: bold; color: #6366f1;">{{ total_events }}</div>
            <div style="font-size: 14px; color: #6b7280;">Total Events</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #10b981;">
            <div style="font-size: 32px; font-weight: bold; color: #10b981;">{{ upcoming_events }}</div>
            <div style="font-size: 14px; color: #6b7280;">Upcoming Events</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #3b82f6;">
            <div style="font-size: 32px; font-weight: bold; color: #3b82f6;">{{ completed_events }}</div>
            <div style="font-size: 14px; color: #6b7280;">Completed Events</div>
        </div>
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #f59e0b;">
            <div style="font-size: 32px; font-weight: bold; color: #f59e0b;">₹{{ total_spent|int }}</div>
            <div style="font-size: 14px; color: #6b7280;">Total Spent</div>
        </div>
    </div>
</div>

<!-- Events List -->
<div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
    <h2 style="margin-bottom: 20px; color: #1f2937;">My Events</h2>
    {% if events %}
        <table style="width: 100%; border-collapse: collapse;">
            <thead style="background: #f9fafb;">
                <tr>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Event Name</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Type</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Date</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Guests</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Status</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Cost</th>
                    <th style="padding: 14px; text-align: left; font-weight: 600; border-bottom: 1px solid #e5e7eb;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for event in events %}
                <tr style="border-bottom: 1px solid #e5e7eb;">
                    <td style="padding: 14px;">
                        <a href="{{ url_for('view_event', event_id=event.id) }}" style="color: #6366f1; text-decoration: none; font-weight: 600;">{{ event.name }}</a>
                    </td>
                    <td style="padding: 14px;">{{ event.event_type }}</td>
                    <td style="padding: 14px;">{{ event.event_date.strftime('%d-%m-%Y') if event.event_date else '—' }}</td>
                    <td style="padding: 14px;">{{ event.expected_guest_count }}</td>
                    <td style="padding: 14px;">
                        {% if event.status.value == 'PENDING' %}
                            {% set status_style = 'background: #fef3c7; color: #78350f;' %}
                        {% elif event.status.value == 'APPROVED' %}
                            {% set status_style = 'background: #d1fae5; color: #065f46;' %}
                        {% elif event.status.value == 'COMPLETED' %}
                            {% set status_style = 'background: #dbeafe; color: #0c2d6b;' %}
                        {% elif event.status.value == 'CANCELLED' %}
                            {% set status_style = 'background: #fee2e2; color: #7f1d1d;' %}
                        {% else %}
                            {% set status_style = 'background: #e5e7eb; color: #1f2937;' %}
                        {% endif %}
                    </td>
                    <td style="padding: 14px;">₹{{ event.total_cost|default(0)|int }}</td>
                    <td style="padding: 14px;">
                        <a href="{{ url_for('view_event', event_id=event.id) }}" style="color: #6366f1; text-decoration: none; font-size: 12px; margin-right: 10px;">View</a>
                        {% if event.is_editable %}
                            <a href="{{ url_for('edit_event', event_id=event.id) }}" style="color: #6366f1; text-decoration: none; font-size: 12px; margin-right: 10px;">Edit</a>
                        {% endif %}
                        <a href="{{ url_for('manage_guests', event_id=event.id) }}" style="color: #6366f1; text-decoration: none; font-size: 12px;">Guests</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div style="text-align: center; padding: 40px; color: #6b7280;">
            <i class="fas fa-calendar-check" style="font-size: 48px; color: #d1d5db; margin-bottom: 15px; display: block;"></i>
            <p style="margin-bottom: 15px;">No events created yet.</p>
            <a href="{{ url_for('create_event') }}" class="btn btn-primary" style="background: #6366f1; color: white; padding: 10px 24px; text-decoration: none; border-radius: 6px;">Create Your First Event</a>
        </div>
    {% endif %}
</div>
{% endblock %}
